
<!DOCTYPE HTML>
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>대략적인 집계</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch: The Definitive Guide" /><link rel="up" href="aggregations.html" title="Aggregations" /><link rel="prev" href="_다중_값_bucket의_정렬.html" title="다중 값 bucket의 정렬" /><link rel="next" href="significant-terms.html" title="의미 있는 단어" />
  
 	<meta http-equiv="content-type" content="text/html; charset=utf-8" />

 	<!-- RTP tag --> 
	<script type='text/javascript' async>
	(function(c,h,a,f,i,e){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
	 c[a].a=i;c[a].e=e;var g=h.createElement("script");g.async=true;g.type="text/javascript";
	 g.src=f+'?aid='+i;var b=h.getElementsByTagName("script")[0];b.parentNode.insertBefore(g,b);
	 })(window,document,"rtp","//sjrtp2-cdn.marketo.com/rtp-api/v1/rtp.js","elasticco");
	 
	rtp('send','view');
	rtp('get', 'campaign',true);
	</script>
	<!-- End of RTP tag -->
	
	
 	<link rel="apple-touch-icon" sizes="57x57"  href="https://www.elastic.co/apple-icon-57x57.png?change=123">
<link rel="apple-touch-icon" sizes="60x60"  href="https://www.elastic.co/apple-icon-60x60.png?change=123">
<link rel="apple-touch-icon" sizes="72x72"  href="https://www.elastic.co/apple-icon-72x72.png?change=123">
<link rel="apple-touch-icon" sizes="76x76"  href="https://www.elastic.co/apple-icon-76x76.png?change=123">
<link rel="apple-touch-icon" sizes="114x114"  href="https://www.elastic.co/apple-icon-114x114.png?change=123">
<link rel="apple-touch-icon" sizes="120x120"  href="https://www.elastic.co/apple-icon-120x120.png?change=123">
<link rel="apple-touch-icon" sizes="144x144"  href="https://www.elastic.co/apple-icon-144x144.png?change=123">
<link rel="apple-touch-icon" sizes="152x152"  href="https://www.elastic.co/apple-icon-152x152.png?change=123">
<link rel="apple-touch-icon" sizes="180x180"  href="https://www.elastic.co/apple-icon-180x180.png?change=123">
<link rel="icon" type="image/png" sizes="192x192"   href="https://www.elastic.co/android-icon-192x192.png?change=123">
<link rel="icon" type="image/png" sizes="32x32"  href="https://www.elastic.co/favicon-32x32.png?change=123">
<link rel="icon" type="image/png" sizes="96x96"  href="https://www.elastic.co/favicon-96x96.png?change=123">
<link rel="icon" type="image/png" sizes="16x16"  href="https://www.elastic.co/favicon-16x16.png?change=123">
<link rel="manifest"  href="https://www.elastic.co/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
<meta name="DC.title" content="Guide template" >

<!-- end DC tags -->

	<meta name="description" content="" />

	<link rel="canonical" href="" />

	<meta property="og:image" content="https://www.elastic.co/static/img/elastic-logo-200.png" />
	


	
	<link type="text/css" rel="stylesheet" href="https://static-www.elastic.co/static/css/skel.css?q=100" />
	<link type="text/css" rel="stylesheet" href="https://static-www.elastic.co/static/css/style.css?q=100" />	
	<script src="https://static-www.elastic.co/static/js/skel.min.js?q=100"></script>
	
		<script type="text/javascript">form_name = "" ; cdn_url="https://static-www.elastic.co";cdn_slug = "100"</script>
	
	<script src="https://static-www.elastic.co/static/js/init.js?q=100"></script>
	<script src="https://static-www.elastic.co/static/js/jquery.min.js?q=100"></script>
	<script src="https://static-www.elastic.co/static/js/jquery.cookie.js?q=100"></script>
	<!--<script type="text/javascript">
	    (function() {
	        var path = '//easy.myfonts.net/v2/js?sid=10336(font-family=Avenir+35+Light)&sid=10338(font-family=Avenir+55+Roman)&sid=10340(font-family=Avenir+85+Heavy)&sid=10344(font-family=Avenir+65+Medium)&key=nAD6PCOPrX',
	            protocol = ('https:' == document.location.protocol ? 'https:' : 'http:'),
	            trial = document.createElement('script');
	        trial.type = 'text/javascript';
	        trial.async = true;
	        trial.src = protocol + path;
	        var head = document.getElementsByTagName("head")[0];
	        head.appendChild(trial);
	    })();
	</script>-->

	
	<link type="text/css" rel="stylesheet"  href="https://www.elastic.co/static/css/prettify.css" />
	<script type="text/javascript"  src="https://www.elastic.co/static/js/prettify.js"></script>



<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
<body >
	<!-- Google Tag Manager -->
	<script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
													  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-58RLH5');</script>
	<!-- End Google Tag Manager -->
	
	<div class="header-cont">
		<div id="header-wrapper">
			


	<script  src="https://www.elastic.co/static/js/jquery.tokeninput.js?change=123"></script>
	<link rel="stylesheet" type="text/css"  href="https://www.elastic.co/static/css/token-input.css">

<div class="shortcuts-wrapper">
	<div class="container">
		<!-- Shortcuts -->
		<nav id="shortcuts">
			<ul class="links">
				
					<li class="shortcut-1">
						<a href="/downloads" id="header_downloads" >
							<span class="txt">downloads</span>	
						</a>
					</li>
				
					<li class="shortcut-2">
						<a href="/guide" id="header_guide" >
							<span class="txt">docs</span>	
						</a>
					</li>
				
					<li class="shortcut-3">
						<a href="/subscriptions" id="header_subscriptions" >
							<span class="txt">support</span>	
						</a>
					</li>
				
					<li class="shortcut-4">
						<a href="https://discuss.elastic.co" id="header_discuss" target="_blank">
							<span class="txt">discuss</span>	
						</a>
					</li>
				
					<li class="shortcut-5">
						<a href="/contact" id="header_contact" >
							<span class="txt">contact</span>	
						</a>
					</li>
				
			</ul>
		</nav>
		<div class="languages-wrapper">
			<div class="global-language">
				<ul class="language">
					<!-- <li class="active-language"><a class="active" href="#">EN</a></li> -->
					
						<li><a href="#">EN</a></li>
					
				</ul>
				<ul class="all-languages">
					
						
						<li><a href="/guide_template">English</a></li>
					
						
						<li><a href="/fr/guide_template">French</a></li>
					
						
						<li><a href="/de/guide_template">German</a></li>
					
						
						<li><a href="/jp/guide_template">Japanese</a></li>
					
						
						<li><a href="/kr/guide_template">Korean</a></li>
					
				</ul>
			</div>
		</div>
	</div>
</div>
<div class="container w100">
	<div class="row 0%">
		<div class="12u">
			

<section class="first-container desktop-main-nav">
	<div class="row 0%">
		<div class="11u 6u(small) 6u(xsmall)">
			<div id="elastic">
				<h1>
					<a href="/">
						<div id="elastic-logo">
						<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 400 130" preserveAspectRatio="xMinYMin meet" enable-background="new 0 0 400 130" xml:space="preserve">
    <g>
    	<g>
    		<path fill="#FFFFFF" d="M122.5,67.8c0-10.3-6.4-19.2-15.9-22.7c0.4-2.2,0.6-4.3,0.6-6.6c0-19.1-15.5-34.6-34.6-34.6
    			c-11.1,0-21.5,5.3-28,14.4c-3.2-2.5-7.1-3.8-11.2-3.8c-10.1,0-18.4,8.2-18.4,18.4c0,2.2,0.4,4.4,1.1,6.4C6.5,42.6,0,51.8,0,62
    			c0,10.3,6.4,19.3,16,22.8c-0.4,2.1-0.6,4.3-0.6,6.6c0,19,15.5,34.5,34.5,34.5c11.2,0,21.5-5.4,28-14.4c3.2,2.5,7.2,3.9,11.3,3.9
    			c10.1,0,18.4-8.2,18.4-18.4c0-2.2-0.4-4.4-1.1-6.4C115.9,87.2,122.5,78,122.5,67.8z"/>
    		<g>
    			<path fill="#F4BD19" d="M47.9,56.3l27.3,12.5l27.6-24.2c0.4-2,0.6-4,0.6-6.1c0-17-13.8-30.8-30.8-30.8c-10.2,0-19.7,5-25.4,13.4
    				l-4.6,23.8L47.9,56.3z"/>
    		</g>
    		<g>
    			<path fill="#3CBEB1" d="M19.6,85.2c-0.4,2-0.6,4.1-0.6,6.2c0,17,13.9,30.9,30.9,30.9c10.3,0,19.8-5.1,25.6-13.5L80,85l-6.1-11.6
    				L46.5,60.9L19.6,85.2z"/>
    		</g>
    		<g>
    			<path fill="#E9478C" d="M19.4,37.9l18.7,4.4L42.3,21c-2.6-2-5.7-3-9-3c-8.1,0-14.8,6.6-14.8,14.8C18.5,34.5,18.8,36.3,19.4,37.9z
    				"/>
    		</g>
    		<g>
    			<path fill="#2C458F" d="M17.8,42.4C9.4,45.1,3.6,53.2,3.6,62c0,8.6,5.3,16.3,13.3,19.3l26.3-23.8l-4.8-10.3L17.8,42.4z"/>
    		</g>
    		<g>
    			<path fill="#95C63D" d="M80.3,108.7c2.6,2,5.7,3.1,8.9,3.1c8.1,0,14.8-6.6,14.8-14.8c0-1.8-0.3-3.5-0.9-5.1l-18.7-4.4L80.3,108.7
    				z"/>
    		</g>
    		<g>
    			<path fill="#176655" d="M84.1,82.6l20.6,4.8c8.4-2.8,14.2-10.8,14.2-19.6c0-8.6-5.3-16.2-13.3-19.3l-27,23.6L84.1,82.6z"/>
    		</g>
    	</g>
    	<path d="M162.8,76.3c0,0.1,0,0.6,0.1,1.4c0.1,0.8,0.3,1.8,0.6,3c0.3,1.1,0.8,2.4,1.4,3.7c0.6,1.3,1.4,2.5,2.5,3.6
    		c1,1.1,2.3,2,3.8,2.7c1.5,0.7,3.4,1.1,5.6,1.1c1.8,0,3.3-0.1,4.6-0.4c1.3-0.3,2.4-0.7,3.4-1.3c1-0.6,1.9-1.3,2.7-2.2
    		c0.8-0.9,1.6-1.9,2.4-3.1c0.5-0.7,1-1.2,1.6-1.5c0.6-0.3,1.2-0.4,1.8-0.4c1,0,2,0.4,2.8,1.1c0.9,0.7,1.3,1.7,1.3,2.8
    		c0,0.7-0.4,1.7-1.1,3.1c-0.7,1.4-1.9,2.8-3.6,4.1c-1.6,1.4-3.7,2.6-6.3,3.6c-2.6,1-5.7,1.5-9.5,1.5c-3.8,0-7.2-0.7-10.2-2.1
    		c-3-1.4-5.5-3.2-7.5-5.6c-2-2.3-3.6-5-4.7-8.1c-1.1-3.1-1.6-6.3-1.6-9.7c0-3.5,0.5-6.8,1.6-9.9c1.1-3.1,2.7-5.8,4.7-8.1
    		c2-2.3,4.5-4.1,7.4-5.5c2.9-1.3,6.1-2,9.6-2c3.3,0,6.3,0.5,9.2,1.5c2.8,1,5.3,2.4,7.4,4.3c2.1,1.9,3.7,4.1,5,6.8
    		c1.2,2.7,1.8,5.8,1.8,9.2c0,2.1-0.5,3.7-1.6,4.8c-1,1.1-2.2,1.6-3.6,1.6H162.8z M170.9,56.4c-1.5,0.6-2.7,1.4-3.7,2.4
    		c-1,0.9-1.8,2-2.4,3.1c-0.6,1.1-1,2.2-1.3,3.2c-0.3,1-0.5,1.8-0.5,2.5c-0.1,0.7-0.1,1.1-0.1,1.2h27.9c0-1.8-0.3-3.5-0.9-5.1
    		c-0.6-1.6-1.5-3-2.6-4.3c-1.2-1.2-2.7-2.2-4.5-3c-1.8-0.7-4-1.1-6.5-1.1C174.2,55.5,172.4,55.8,170.9,56.4z"/>
    	<path d="M214.3,94.6c0,1.3-0.4,2.3-1.3,3.2c-0.9,0.9-1.9,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2V35.1
    		c0-1.3,0.4-2.3,1.3-3.2c0.9-0.9,2-1.3,3.2-1.3c1.3,0,2.3,0.4,3.2,1.3c0.9,0.9,1.3,1.9,1.3,3.2V94.6z"/>
    	<path d="M229.8,63.5c-0.6,0.3-1.2,0.5-1.9,0.5c-1.2,0-2.2-0.4-3.2-1.1c-1-0.7-1.5-1.8-1.5-3.1c0-0.5,0.1-1.1,0.4-1.9
    		c0.5-1.2,1.2-2.4,2.1-3.6c0.9-1.2,2-2.2,3.5-3.1s3.3-1.7,5.4-2.2c2.2-0.5,4.8-0.8,7.9-0.8c5.9,0,10.5,1.2,14,3.5
    		c3.5,2.3,5.2,5.8,5.2,10.3v32.8c0,1.3-0.4,2.3-1.3,3.2c-0.9,0.9-1.9,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2v-2
    		c-1.2,2-4.7,4.5-7.5,5.3c-2.8,0.8-5.7,1.2-8.8,1.2c-2,0-3.9-0.3-5.9-0.8c-2-0.5-3.8-1.4-5.3-2.5c-1.6-1.1-2.9-2.6-3.8-4.3
    		c-1-1.7-1.5-3.8-1.5-6.2c0-2.8,0.5-5.7,1.6-7.5c1.1-1.9,2.6-3.4,4.4-4.6c1.8-1.2,3.9-2.1,6.3-2.8c2.4-0.6,4.9-1.1,7.5-1.4
    		c3-0.3,5.4-0.7,7.2-1.2c1.7-0.4,3-0.9,3.9-1.5c0.9-0.6,1.4-1.2,1.6-2c0.2-0.7,0.3-1.6,0.3-2.5c0-1.1-0.3-2-0.9-2.8
    		c-0.6-0.8-1.4-1.5-2.4-2c-1-0.5-2.1-0.9-3.3-1.2s-2.4-0.4-3.5-0.4c-2.1,0-3.7,0.2-5,0.5c-1.3,0.3-2.3,0.8-3.1,1.4
    		c-0.8,0.6-1.5,1.3-1.9,2.1c-0.5,0.8-0.9,1.6-1.3,2.5C230.9,62.6,230.4,63.1,229.8,63.5z M250.6,74.4c-1.1,0.3-2.4,0.6-3.8,0.8
    		c-1.5,0.2-3,0.4-4.6,0.6c-1.6,0.2-3.1,0.5-4.6,0.9c-1.5,0.3-2.8,0.8-4,1.5c-1.2,0.7-2.2,1.5-2.9,2.5c-0.7,1-1.1,3-1.1,4.6
    		c0,1.3,0.3,2.3,0.8,3.1c0.5,0.8,1.2,1.5,2.1,2c0.9,0.5,1.8,0.8,2.9,1c1.1,0.2,2.2,0.3,3.3,0.3c1.7,0,3.3-0.2,5-0.6
    		c1.7-0.4,3.2-1,4.5-1.9s2.4-2,3.3-3.5c0.8-1.4,1.2-3.8,1.2-5.9v-6.1L250.6,74.4z"/>
    	<path d="M307.6,90.9c-1.1,2-2.7,3.6-4.6,4.8s-4.1,2.1-6.6,2.7c-2.5,0.5-5.2,0.8-7.9,0.8c-3.9,0-7.2-0.6-9.9-1.8
    		c-2.7-1.2-4.9-2.6-6.5-4.1c-1.7-1.6-2.9-3.1-3.7-4.7c-0.7-1.6-1.1-2.7-1.1-3.5c0-1.3,0.5-2.4,1.4-3.2c0.9-0.8,2-1.2,3.1-1.2
    		c0.7,0,1.3,0.2,2,0.6c0.6,0.4,1.1,1,1.5,1.9c1,2.5,2.5,4.5,4.7,6.2c2.2,1.7,5.2,2.5,9.3,2.5c1.8,0,3.4-0.2,4.7-0.6
    		c1.3-0.4,2.4-1,3.2-1.7c0.8-0.7,1.4-1.5,1.9-2.4c0.4-0.9,0.6-1.8,0.6-2.8c0-2-0.8-3.4-2.3-4.4c-1.5-1-3.5-1.7-5.8-2.3
    		c-2.3-0.6-4.8-1.1-7.5-1.6c-2.7-0.5-5.2-1.2-7.5-2.2c-2.3-0.9-4.2-2.3-5.8-4c-1.6-1.8-2.3-4.2-2.3-7.3c0-4.5,1.6-8,4.9-10.5
    		c3.3-2.5,7.8-3.8,13.7-3.8c3.3,0,6,0.3,8.3,1c2.2,0.7,4.1,1.6,5.5,2.7c0.6,0.5,1.2,1,1.8,1.7c0.6,0.7,1.2,1.4,1.8,2.2
    		c0.6,0.8,1,1.5,1.4,2.3c0.4,0.7,0.6,1.4,0.6,2c0,1.3-0.5,2.4-1.6,3.1c-1,0.8-2.2,1.2-3.4,1.2c-0.7,0-1.5-0.1-2.1-0.6
    		c-0.6-0.6-1-1.3-1.3-1.8c-0.5-1.1-1.1-2-1.7-2.8c-0.5-0.8-1.2-1.5-2-2c-0.8-0.5-1.8-0.9-3-1.2c-1.2-0.3-2.7-0.4-4.4-0.4
    		c-3.5,0-6,0.6-7.6,1.7c-1.6,1.1-2.4,2.5-2.4,4.2c0,1.3,0.5,2.3,1.4,3.1c0.9,0.8,2.1,1.4,3.7,2c1.5,0.5,3.3,1,5.2,1.4
    		c2,0.4,3.9,0.8,5.9,1.3c2,0.5,4,1.1,5.9,1.7c1.9,0.7,3.7,1.6,5.2,2.7c1.5,1.1,2.7,2.5,3.7,4.1c0.9,1.6,1.4,3.6,1.4,6
    		C309.4,86.4,308.8,88.9,307.6,90.9z"/>
    	<path d="M327.4,48.8h4.7c1.1,0,2,0.4,2.8,1.2c0.8,0.8,1.2,1.7,1.2,2.8c0,1.1-0.4,2.1-1.2,2.8s-1.7,1.1-2.8,1.1h-4.7v37.9
    		c0,1.3-0.4,2.3-1.3,3.2c-0.9,0.9-2,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2V56.7h-4.6c-1.1,0-2-0.4-2.8-1.1
    		c-0.8-0.7-1.2-1.7-1.2-2.8c0-1.1,0.4-2,1.2-2.8c0.8-0.8,1.7-1.2,2.8-1.2h4.6V39c0-1.3,0.4-2.3,1.3-3.2s1.9-1.3,3.2-1.3
    		c1.3,0,2.3,0.4,3.2,1.3s1.3,1.9,1.3,3.2V48.8z"/>
    	<path d="M341.5,32.1c1-1,2.2-1.5,3.7-1.5c1.4,0,2.6,0.5,3.6,1.5c1,1,1.5,2.2,1.5,3.6c0,1.4-0.5,2.6-1.5,3.6c-1,1-2.2,1.5-3.6,1.5
    		c-1.4,0-2.7-0.5-3.7-1.5c-1-1-1.5-2.2-1.5-3.6C340,34.2,340.5,33,341.5,32.1z M349.6,94.6c0,1.3-0.4,2.3-1.3,3.2
    		c-0.9,0.9-1.9,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2V53.3c0-1.3,0.4-2.3,1.3-3.2c0.9-0.9,2-1.3,3.2-1.3
    		c1.3,0,2.3,0.4,3.2,1.3c0.9,0.9,1.3,2,1.3,3.2V94.6z"/>
    	<path d="M369.1,97.3c-2.9-1.2-5.4-3-7.5-5.2c-2.1-2.2-3.8-4.9-5-8.1c-1.2-3.1-1.8-6.6-1.8-10.4c0-3.8,0.6-7.3,1.8-10.5
    		c1.2-3.1,2.9-5.8,5-8.1c2.1-2.2,4.6-4,7.5-5.2c2.9-1.2,6-1.9,9.4-1.9c3.4,0,6.4,0.5,9,1.5c2.5,1,4.6,2.2,6.2,3.6
    		c1.6,1.4,3.2,2.9,4,4.4c0.5,0.9,0.9,1.5,0.9,2.6c0,1.3-0.5,2.3-1.4,3.1c-0.9,0.7-2,1.1-3.1,1.1c-0.8,0-1.6-0.2-2.2-0.6
    		c-0.7-0.4-1.2-1.3-1.8-2.1c-1-1.4-0.5-0.6-1.1-1.5c-0.7-0.9-1.5-1.6-2.5-2.3c-1-0.7-2.2-1.2-3.5-1.6c-1.4-0.4-2.8-0.6-4.4-0.6
    		c-1.8,0-3.5,0.3-5.3,1c-1.8,0.7-3.3,1.7-4.7,3.1c-1.4,1.4-2.5,3.3-3.4,5.6s-1.3,5.1-1.3,8.4c0,3.3,0.4,6.1,1.3,8.4s2,4.2,3.4,5.6
    		c1.4,1.4,3,2.5,4.7,3.1c1.8,0.7,3.5,1,5.3,1c1.6,0,3.1-0.2,4.4-0.6c1.3-0.4,2.5-0.9,3.5-1.6c1-0.7,1.8-1.5,2.5-2.3
    		c0.7-0.9,1.1-1.8,1.4-2.7c0.3-1,0.8-1.7,1.5-2.1c0.7-0.4,1.4-0.6,2.2-0.6c1.1,0,2.2,0.4,3.1,1.1c0.9,0.7,1.4,1.7,1.4,3
    		c0,0.6-0.3,1.7-0.9,3.1c-0.6,1.5-1.6,2.9-3.1,4.4c-1.5,1.5-3.5,2.8-6.2,4c-2.6,1.1-6,1.7-10,1.7C375.1,99.2,372,98.5,369.1,97.3z"
    		/>
    </g>
</svg>
						</div>
					</a>
				</h1>
			</div>
			<nav id="nav">
				<ul>
					
					<li>
						
							
						
						<a href="/products" id="nav_products"   >Products</a>
						
						<ul class="dropdown">
							
								<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>								
							
								<li><a href="/found" id="nav_hosted-elasticsearch" >elasticsearch as a service</a></li>								
							
								<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>								
							
								<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>								
							
								<li><a href="/products/beats" id="nav_beats" >beats</a></li>								
							
								<li><a href="/products/watcher" id="nav_watcher" >watcher</a></li>								
							
								<li><a href="/products/shield" id="nav_shield" >shield</a></li>								
							
								<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>								
							
								<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>								
							
								<li><a href="/downloads" id="nav_downloads" >downloads</a></li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/subscriptions" id="nav_subscriptions"   >Subscriptions</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/learn" id="nav_learn"   >Learn</a>
						
						<ul class="dropdown">
							
								<li><a href="/guide" id="nav_guide" >docs</a></li>								
							
								<li><a href="/videos" id="nav_videos" >videos</a></li>								
							
								<li><a href="/training" id="nav_training" >training</a></li>								
							
								<li><a href="/services" id="nav_services" >services</a></li>								
							
								<li><a href="/blog" id="nav_learn_blog" >blog</a></li>								
							
								<li><a href="/elasticon" id="nav_learn_elasticon" >elastic{ON}</a></li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/community" id="nav_community"   >Community</a>
						
						<ul class="dropdown">
							
								<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>								
							
								<li><a href="https://discuss.elastic.co" id="nav_discuss" target="_blank">discuss</a></li>								
							
								<li><a href="/community/codeofconduct" id="nav_codeofconduct" >code of conduct</a></li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/use-cases" id="nav_usecases"   >Use Cases</a>
						
						<ul class="dropdown">
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/blog" id="nav_blog"   >Blog</a>
						
						<ul class="dropdown">
							
								<li><a href="/blog/category/news" id="blog_news" >News</a></li>								
							
								<li><a href="/blog/category/engineering" id="blog_engineering" >Engineering</a></li>								
							
								<li><a href="/blog/category/user-stories" id="blog_user-stories" >User Stories</a></li>								
							
								<li><a href="/blog/category/releases" id="blog_releases" >Releases</a></li>								
							
								<li><a href="/blog/archive" id="blog_archive" >Archive</a></li>								
								
						</ul>							
					</li>
					
					<li>
						
							
						
						<a href="/about" id="nav_about"   >About</a>
						
						<ul class="dropdown">
							
								<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>								
							
								<li><a href="/about/board" id="nav_board" >board of directors</a></li>								
							
								<li><a href="/about/careers" id="nav_careers" >careers</a></li>								
							
								<li><a href="/about/partners" id="nav_partners" >partners</a></li>								
							
								<li><a href="/about/press" id="nav_press" >press</a></li>								
								
						</ul>							
					</li>
					
				</ul>
			</nav>			
			<!-- Searchbar Input box -->
			 <!-- <form method="get" action="/search" name="searchForm" class="header-search-form" id="searchMobileFrm">
			   <input type="text" id="search-header-autocomplete" name="q" class="form-control global-input" placeholder="elastic{search}">
			</form>
			<div class="mobile-auto-complete"></div> -->  
		</div>
		<div class="1u 6u(small) 6u(xsmall)">
			<div id="searchbar">
				<a href="#" class="button icon"></a>
			</div>
			<!-- <div class="nav-auto-complete"></div> -->
		</div>
	</div>
</section>
<div class="mobile-menu-wrapper">
	<div class="row 0%">
		<div class="8u 6u(small) 6u(xsmall)">
			<div id="elastic">
				<h1>
					<a href="/">
						<div id="elastic-logo">
						<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 400 130" preserveAspectRatio="xMinYMin meet" enable-background="new 0 0 400 130" xml:space="preserve">
    <g>
    	<g>
    		<path fill="#FFFFFF" d="M122.5,67.8c0-10.3-6.4-19.2-15.9-22.7c0.4-2.2,0.6-4.3,0.6-6.6c0-19.1-15.5-34.6-34.6-34.6
    			c-11.1,0-21.5,5.3-28,14.4c-3.2-2.5-7.1-3.8-11.2-3.8c-10.1,0-18.4,8.2-18.4,18.4c0,2.2,0.4,4.4,1.1,6.4C6.5,42.6,0,51.8,0,62
    			c0,10.3,6.4,19.3,16,22.8c-0.4,2.1-0.6,4.3-0.6,6.6c0,19,15.5,34.5,34.5,34.5c11.2,0,21.5-5.4,28-14.4c3.2,2.5,7.2,3.9,11.3,3.9
    			c10.1,0,18.4-8.2,18.4-18.4c0-2.2-0.4-4.4-1.1-6.4C115.9,87.2,122.5,78,122.5,67.8z"/>
    		<g>
    			<path fill="#F4BD19" d="M47.9,56.3l27.3,12.5l27.6-24.2c0.4-2,0.6-4,0.6-6.1c0-17-13.8-30.8-30.8-30.8c-10.2,0-19.7,5-25.4,13.4
    				l-4.6,23.8L47.9,56.3z"/>
    		</g>
    		<g>
    			<path fill="#3CBEB1" d="M19.6,85.2c-0.4,2-0.6,4.1-0.6,6.2c0,17,13.9,30.9,30.9,30.9c10.3,0,19.8-5.1,25.6-13.5L80,85l-6.1-11.6
    				L46.5,60.9L19.6,85.2z"/>
    		</g>
    		<g>
    			<path fill="#E9478C" d="M19.4,37.9l18.7,4.4L42.3,21c-2.6-2-5.7-3-9-3c-8.1,0-14.8,6.6-14.8,14.8C18.5,34.5,18.8,36.3,19.4,37.9z
    				"/>
    		</g>
    		<g>
    			<path fill="#2C458F" d="M17.8,42.4C9.4,45.1,3.6,53.2,3.6,62c0,8.6,5.3,16.3,13.3,19.3l26.3-23.8l-4.8-10.3L17.8,42.4z"/>
    		</g>
    		<g>
    			<path fill="#95C63D" d="M80.3,108.7c2.6,2,5.7,3.1,8.9,3.1c8.1,0,14.8-6.6,14.8-14.8c0-1.8-0.3-3.5-0.9-5.1l-18.7-4.4L80.3,108.7
    				z"/>
    		</g>
    		<g>
    			<path fill="#176655" d="M84.1,82.6l20.6,4.8c8.4-2.8,14.2-10.8,14.2-19.6c0-8.6-5.3-16.2-13.3-19.3l-27,23.6L84.1,82.6z"/>
    		</g>
    	</g>
    	<path d="M162.8,76.3c0,0.1,0,0.6,0.1,1.4c0.1,0.8,0.3,1.8,0.6,3c0.3,1.1,0.8,2.4,1.4,3.7c0.6,1.3,1.4,2.5,2.5,3.6
    		c1,1.1,2.3,2,3.8,2.7c1.5,0.7,3.4,1.1,5.6,1.1c1.8,0,3.3-0.1,4.6-0.4c1.3-0.3,2.4-0.7,3.4-1.3c1-0.6,1.9-1.3,2.7-2.2
    		c0.8-0.9,1.6-1.9,2.4-3.1c0.5-0.7,1-1.2,1.6-1.5c0.6-0.3,1.2-0.4,1.8-0.4c1,0,2,0.4,2.8,1.1c0.9,0.7,1.3,1.7,1.3,2.8
    		c0,0.7-0.4,1.7-1.1,3.1c-0.7,1.4-1.9,2.8-3.6,4.1c-1.6,1.4-3.7,2.6-6.3,3.6c-2.6,1-5.7,1.5-9.5,1.5c-3.8,0-7.2-0.7-10.2-2.1
    		c-3-1.4-5.5-3.2-7.5-5.6c-2-2.3-3.6-5-4.7-8.1c-1.1-3.1-1.6-6.3-1.6-9.7c0-3.5,0.5-6.8,1.6-9.9c1.1-3.1,2.7-5.8,4.7-8.1
    		c2-2.3,4.5-4.1,7.4-5.5c2.9-1.3,6.1-2,9.6-2c3.3,0,6.3,0.5,9.2,1.5c2.8,1,5.3,2.4,7.4,4.3c2.1,1.9,3.7,4.1,5,6.8
    		c1.2,2.7,1.8,5.8,1.8,9.2c0,2.1-0.5,3.7-1.6,4.8c-1,1.1-2.2,1.6-3.6,1.6H162.8z M170.9,56.4c-1.5,0.6-2.7,1.4-3.7,2.4
    		c-1,0.9-1.8,2-2.4,3.1c-0.6,1.1-1,2.2-1.3,3.2c-0.3,1-0.5,1.8-0.5,2.5c-0.1,0.7-0.1,1.1-0.1,1.2h27.9c0-1.8-0.3-3.5-0.9-5.1
    		c-0.6-1.6-1.5-3-2.6-4.3c-1.2-1.2-2.7-2.2-4.5-3c-1.8-0.7-4-1.1-6.5-1.1C174.2,55.5,172.4,55.8,170.9,56.4z"/>
    	<path d="M214.3,94.6c0,1.3-0.4,2.3-1.3,3.2c-0.9,0.9-1.9,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2V35.1
    		c0-1.3,0.4-2.3,1.3-3.2c0.9-0.9,2-1.3,3.2-1.3c1.3,0,2.3,0.4,3.2,1.3c0.9,0.9,1.3,1.9,1.3,3.2V94.6z"/>
    	<path d="M229.8,63.5c-0.6,0.3-1.2,0.5-1.9,0.5c-1.2,0-2.2-0.4-3.2-1.1c-1-0.7-1.5-1.8-1.5-3.1c0-0.5,0.1-1.1,0.4-1.9
    		c0.5-1.2,1.2-2.4,2.1-3.6c0.9-1.2,2-2.2,3.5-3.1s3.3-1.7,5.4-2.2c2.2-0.5,4.8-0.8,7.9-0.8c5.9,0,10.5,1.2,14,3.5
    		c3.5,2.3,5.2,5.8,5.2,10.3v32.8c0,1.3-0.4,2.3-1.3,3.2c-0.9,0.9-1.9,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2v-2
    		c-1.2,2-4.7,4.5-7.5,5.3c-2.8,0.8-5.7,1.2-8.8,1.2c-2,0-3.9-0.3-5.9-0.8c-2-0.5-3.8-1.4-5.3-2.5c-1.6-1.1-2.9-2.6-3.8-4.3
    		c-1-1.7-1.5-3.8-1.5-6.2c0-2.8,0.5-5.7,1.6-7.5c1.1-1.9,2.6-3.4,4.4-4.6c1.8-1.2,3.9-2.1,6.3-2.8c2.4-0.6,4.9-1.1,7.5-1.4
    		c3-0.3,5.4-0.7,7.2-1.2c1.7-0.4,3-0.9,3.9-1.5c0.9-0.6,1.4-1.2,1.6-2c0.2-0.7,0.3-1.6,0.3-2.5c0-1.1-0.3-2-0.9-2.8
    		c-0.6-0.8-1.4-1.5-2.4-2c-1-0.5-2.1-0.9-3.3-1.2s-2.4-0.4-3.5-0.4c-2.1,0-3.7,0.2-5,0.5c-1.3,0.3-2.3,0.8-3.1,1.4
    		c-0.8,0.6-1.5,1.3-1.9,2.1c-0.5,0.8-0.9,1.6-1.3,2.5C230.9,62.6,230.4,63.1,229.8,63.5z M250.6,74.4c-1.1,0.3-2.4,0.6-3.8,0.8
    		c-1.5,0.2-3,0.4-4.6,0.6c-1.6,0.2-3.1,0.5-4.6,0.9c-1.5,0.3-2.8,0.8-4,1.5c-1.2,0.7-2.2,1.5-2.9,2.5c-0.7,1-1.1,3-1.1,4.6
    		c0,1.3,0.3,2.3,0.8,3.1c0.5,0.8,1.2,1.5,2.1,2c0.9,0.5,1.8,0.8,2.9,1c1.1,0.2,2.2,0.3,3.3,0.3c1.7,0,3.3-0.2,5-0.6
    		c1.7-0.4,3.2-1,4.5-1.9s2.4-2,3.3-3.5c0.8-1.4,1.2-3.8,1.2-5.9v-6.1L250.6,74.4z"/>
    	<path d="M307.6,90.9c-1.1,2-2.7,3.6-4.6,4.8s-4.1,2.1-6.6,2.7c-2.5,0.5-5.2,0.8-7.9,0.8c-3.9,0-7.2-0.6-9.9-1.8
    		c-2.7-1.2-4.9-2.6-6.5-4.1c-1.7-1.6-2.9-3.1-3.7-4.7c-0.7-1.6-1.1-2.7-1.1-3.5c0-1.3,0.5-2.4,1.4-3.2c0.9-0.8,2-1.2,3.1-1.2
    		c0.7,0,1.3,0.2,2,0.6c0.6,0.4,1.1,1,1.5,1.9c1,2.5,2.5,4.5,4.7,6.2c2.2,1.7,5.2,2.5,9.3,2.5c1.8,0,3.4-0.2,4.7-0.6
    		c1.3-0.4,2.4-1,3.2-1.7c0.8-0.7,1.4-1.5,1.9-2.4c0.4-0.9,0.6-1.8,0.6-2.8c0-2-0.8-3.4-2.3-4.4c-1.5-1-3.5-1.7-5.8-2.3
    		c-2.3-0.6-4.8-1.1-7.5-1.6c-2.7-0.5-5.2-1.2-7.5-2.2c-2.3-0.9-4.2-2.3-5.8-4c-1.6-1.8-2.3-4.2-2.3-7.3c0-4.5,1.6-8,4.9-10.5
    		c3.3-2.5,7.8-3.8,13.7-3.8c3.3,0,6,0.3,8.3,1c2.2,0.7,4.1,1.6,5.5,2.7c0.6,0.5,1.2,1,1.8,1.7c0.6,0.7,1.2,1.4,1.8,2.2
    		c0.6,0.8,1,1.5,1.4,2.3c0.4,0.7,0.6,1.4,0.6,2c0,1.3-0.5,2.4-1.6,3.1c-1,0.8-2.2,1.2-3.4,1.2c-0.7,0-1.5-0.1-2.1-0.6
    		c-0.6-0.6-1-1.3-1.3-1.8c-0.5-1.1-1.1-2-1.7-2.8c-0.5-0.8-1.2-1.5-2-2c-0.8-0.5-1.8-0.9-3-1.2c-1.2-0.3-2.7-0.4-4.4-0.4
    		c-3.5,0-6,0.6-7.6,1.7c-1.6,1.1-2.4,2.5-2.4,4.2c0,1.3,0.5,2.3,1.4,3.1c0.9,0.8,2.1,1.4,3.7,2c1.5,0.5,3.3,1,5.2,1.4
    		c2,0.4,3.9,0.8,5.9,1.3c2,0.5,4,1.1,5.9,1.7c1.9,0.7,3.7,1.6,5.2,2.7c1.5,1.1,2.7,2.5,3.7,4.1c0.9,1.6,1.4,3.6,1.4,6
    		C309.4,86.4,308.8,88.9,307.6,90.9z"/>
    	<path d="M327.4,48.8h4.7c1.1,0,2,0.4,2.8,1.2c0.8,0.8,1.2,1.7,1.2,2.8c0,1.1-0.4,2.1-1.2,2.8s-1.7,1.1-2.8,1.1h-4.7v37.9
    		c0,1.3-0.4,2.3-1.3,3.2c-0.9,0.9-2,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2V56.7h-4.6c-1.1,0-2-0.4-2.8-1.1
    		c-0.8-0.7-1.2-1.7-1.2-2.8c0-1.1,0.4-2,1.2-2.8c0.8-0.8,1.7-1.2,2.8-1.2h4.6V39c0-1.3,0.4-2.3,1.3-3.2s1.9-1.3,3.2-1.3
    		c1.3,0,2.3,0.4,3.2,1.3s1.3,1.9,1.3,3.2V48.8z"/>
    	<path d="M341.5,32.1c1-1,2.2-1.5,3.7-1.5c1.4,0,2.6,0.5,3.6,1.5c1,1,1.5,2.2,1.5,3.6c0,1.4-0.5,2.6-1.5,3.6c-1,1-2.2,1.5-3.6,1.5
    		c-1.4,0-2.7-0.5-3.7-1.5c-1-1-1.5-2.2-1.5-3.6C340,34.2,340.5,33,341.5,32.1z M349.6,94.6c0,1.3-0.4,2.3-1.3,3.2
    		c-0.9,0.9-1.9,1.3-3.2,1.3c-1.3,0-2.3-0.4-3.2-1.3c-0.9-0.9-1.3-2-1.3-3.2V53.3c0-1.3,0.4-2.3,1.3-3.2c0.9-0.9,2-1.3,3.2-1.3
    		c1.3,0,2.3,0.4,3.2,1.3c0.9,0.9,1.3,2,1.3,3.2V94.6z"/>
    	<path d="M369.1,97.3c-2.9-1.2-5.4-3-7.5-5.2c-2.1-2.2-3.8-4.9-5-8.1c-1.2-3.1-1.8-6.6-1.8-10.4c0-3.8,0.6-7.3,1.8-10.5
    		c1.2-3.1,2.9-5.8,5-8.1c2.1-2.2,4.6-4,7.5-5.2c2.9-1.2,6-1.9,9.4-1.9c3.4,0,6.4,0.5,9,1.5c2.5,1,4.6,2.2,6.2,3.6
    		c1.6,1.4,3.2,2.9,4,4.4c0.5,0.9,0.9,1.5,0.9,2.6c0,1.3-0.5,2.3-1.4,3.1c-0.9,0.7-2,1.1-3.1,1.1c-0.8,0-1.6-0.2-2.2-0.6
    		c-0.7-0.4-1.2-1.3-1.8-2.1c-1-1.4-0.5-0.6-1.1-1.5c-0.7-0.9-1.5-1.6-2.5-2.3c-1-0.7-2.2-1.2-3.5-1.6c-1.4-0.4-2.8-0.6-4.4-0.6
    		c-1.8,0-3.5,0.3-5.3,1c-1.8,0.7-3.3,1.7-4.7,3.1c-1.4,1.4-2.5,3.3-3.4,5.6s-1.3,5.1-1.3,8.4c0,3.3,0.4,6.1,1.3,8.4s2,4.2,3.4,5.6
    		c1.4,1.4,3,2.5,4.7,3.1c1.8,0.7,3.5,1,5.3,1c1.6,0,3.1-0.2,4.4-0.6c1.3-0.4,2.5-0.9,3.5-1.6c1-0.7,1.8-1.5,2.5-2.3
    		c0.7-0.9,1.1-1.8,1.4-2.7c0.3-1,0.8-1.7,1.5-2.1c0.7-0.4,1.4-0.6,2.2-0.6c1.1,0,2.2,0.4,3.1,1.1c0.9,0.7,1.4,1.7,1.4,3
    		c0,0.6-0.3,1.7-0.9,3.1c-0.6,1.5-1.6,2.9-3.1,4.4c-1.5,1.5-3.5,2.8-6.2,4c-2.6,1.1-6,1.7-10,1.7C375.1,99.2,372,98.5,369.1,97.3z"
    		/>
    </g>
</svg>
						</div>
					</a>
				</h1>
			</div>
		</div>
		<div class="4u 6u(small) 6u(xsmall) text-right">
			<!-- <div class="mobile-menu-wrapper"> -->
				<ul class="m-shortcuts">
					
					<li><a href="#" class="m-search" id="header-search"></a></li>
					
					<li><a href="/guide" class="m-docs" id="mobile-docs"></a></li>
					
					<li><a href="/contact" class="m-contact" id="mobile-contact"></a></li>
					
				</ul>	
				<nav class="nav-menu">
					<div class="menu-button">
						<span></span>
					</div>
					<div class="nav-menu-list-wrap">
						<div class="nav-menu-list">
							
								<h3><a href="/products" id="nav_products" >Products</a></h3>

								
								<ul>
									
									<li><a href="/products/elasticsearch" id="nav_elasticsearch" >elasticsearch</a></li>
									
									<li><a href="/found" id="nav_hosted-elasticsearch" >elasticsearch as a service</a></li>
									
									<li><a href="/products/logstash" id="nav_logstash" >logstash</a></li>
									
									<li><a href="/products/kibana" id="nav_kibana" >kibana</a></li>
									
									<li><a href="/products/beats" id="nav_beats" >beats</a></li>
									
									<li><a href="/products/watcher" id="nav_watcher" >watcher</a></li>
									
									<li><a href="/products/shield" id="nav_shield" >shield</a></li>
									
									<li><a href="/products/marvel" id="nav_marvel" >marvel</a></li>
									
									<li><a href="/products/hadoop" id="nav_hadoop" >hadoop</a></li>
									
									<li><a href="/downloads" id="nav_downloads" >downloads</a></li>
									
								</ul>
								
							
								<h3><a href="/subscriptions" id="nav_subscriptions" >Subscriptions</a></h3>

								
							
								<h3><a href="/learn" id="nav_learn" >Learn</a></h3>

								
								<ul>
									
									<li><a href="/guide" id="nav_guide" >docs</a></li>
									
									<li><a href="/videos" id="nav_videos" >videos</a></li>
									
									<li><a href="/training" id="nav_training" >training</a></li>
									
									<li><a href="/services" id="nav_services" >services</a></li>
									
									<li><a href="/blog" id="nav_learn_blog" >blog</a></li>
									
									<li><a href="/elasticon" id="nav_learn_elasticon" >elastic{ON}</a></li>
									
								</ul>
								
							
								<h3><a href="/community" id="nav_community" >Community</a></h3>

								
								<ul>
									
									<li><a href="/community/meetups" id="nav_meetups" >meetups</a></li>
									
									<li><a href="/https:/discuss.elastic.co" id="nav_discuss" target="_blank">discuss</a></li>
									
									<li><a href="/community/codeofconduct" id="nav_codeofconduct" >code of conduct</a></li>
									
								</ul>
								
							
								<h3><a href="/use-cases" id="nav_usecases" >Use Cases</a></h3>

								
							
								<h3><a href="/blog" id="nav_blog" >Blog</a></h3>

								
								<ul>
									
									<li><a href="/blog/category/news" id="blog_news" >News</a></li>
									
									<li><a href="/blog/category/engineering" id="blog_engineering" >Engineering</a></li>
									
									<li><a href="/blog/category/user-stories" id="blog_user-stories" >User Stories</a></li>
									
									<li><a href="/blog/category/releases" id="blog_releases" >Releases</a></li>
									
									<li><a href="/blog/archive" id="blog_archive" >Archive</a></li>
									
								</ul>
								
							
								<h3><a href="/about" id="nav_about" >About</a></h3>

								
								<ul>
									
									<li><a href="/about/leadership" id="nav_leadership" >leadership</a></li>
									
									<li><a href="/about/board" id="nav_board" >board of directors</a></li>
									
									<li><a href="/about/careers" id="nav_careers" >careers</a></li>
									
									<li><a href="/about/partners" id="nav_partners" >partners</a></li>
									
									<li><a href="/about/press" id="nav_press" >press</a></li>
									
								</ul>
								
							
						</div>
					</div>
				</nav>
			<!-- </div> -->
		</div>
	</div>
</div>
<!-- Mobile Menu -->


		</div>
	</div>
</div>
<div class="header-search-wrapper">	
	<div class="container">
		<div class="big-search">
			<i class="big-search-icon"></i>
			<form method="get" action="/search" autocomplete="on" name="searchForm" id="searchfrm">
				<ul class="tags-wrapper">
					<li class="search-field"><input type="text" class="form-control global-input" id="autocomplete" name="q"></li>
				</ul>
			</form>
			<a href="#" class="header-search-cancel"></a>
		</div>
		<div class="nav-auto-complete"></div>
	</div>
</div>
<style>	
	
	
		.m-shortcuts li a.m-search {
			background: url("https://static-www.elastic.co/assets/blt174b13be89ff803c/m-search-icon.png?q=100") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
	
		.m-shortcuts li a.m-docs {
			background: url("https://static-www.elastic.co/assets/blt5ba03f594a7d610a/m-guide-icon.png?q=100") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
	
		.m-shortcuts li a.m-contact {
			background: url("https://static-www.elastic.co/assets/blt38c3e853c4b1174d/m-contact-icon.png?q=100") no-repeat scroll center center rgba(0, 0, 0, 0);
			background-size: contain;}
		
</style>
		</div>
	</div>
  	<div id="content">
  		
  			
            <div id="pageheader">
    <div class="container">
        <header>
            <h1><a href="/learn" title="Learn">Learn</a> |</h1>
            <h2><a href="/guide" title="Docs">Docs</a></h2>
        </header>
    </div>
</div>
<section id="guide">

            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch: The Definitive Guide</a></span> » <span class="breadcrumb-link"><a href="aggregations.html">Aggregations </a></span> » <span class="breadcrumb-node">대략적인 집계</span></div><div class="navheader"><span class="prev"><a href="_다중_값_bucket의_정렬.html">
              « 
              다중 값 bucket의 정렬</a>
           
        </span><span class="next">
           
          <a href="significant-terms.html">의미 있는 단어
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="_대략적인_집계"></a>대략적인 집계</h2></div></div></div><p>모든 데이터가 단일 시스템으로 충분하다면, 참 쉬울 것이다.<a id="id-1.7.10.2.1" class="indexterm"></a>
<a id="id-1.7.10.2.2" class="indexterm"></a> CS201에서 배운 고전적인 알고리즘으로, 모든 요구를 충족시킬 것이다.
하지만, 모든 데이터가 단일 시스템으로 충분하다면, Elasticsearch 같은 분산 소프트웨어가 불필요할 것이다. 그러나, 데이터를 분산하기 시작하면, 알고리즘의 선택은 신중해야 한다.</p><p>어떤 알고리즘은 분산 실행을 해야 한다. 지금까지 언급했던 모든 집계는 단일-경로(single-path)에서 실행하고, 정확한 결과를 제공한다.
이런 유형의 알고리즘은 약간의 노력으로, 여러 시스템에 병렬이어서, 종종 <code class="literal">당혹스러운(embarrassingly) 병렬</code> 이라고 한다.
예를 들어, <code class="literal">max</code> metric을 실행하는 경우, 기본 알고리즘은 매우 간단하다.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
모든 shard에 요청을 전달(broadcast)한다.
</li><li class="listitem">
각 document에 대해, <code class="literal">price</code> field를 확인한다. <code class="literal">price가 current_max보다 크면</code>, <code class="literal">current_max</code> 를 <code class="literal">price</code> 로 바꾼다.
</li><li class="listitem">
모든 shard에서 최대 가격을 조정 node로 반환한다.
</li><li class="listitem">
모든 shard에서 반환된 price에서 최대값을 찾는다. 이것이 진짜 최대값이다.
</li></ol></div><p>알고리즘은 어떤 조정(시스템은 중간 결과를 확인할 필요가 없다.)도 필요하지 않기 때문에,
알고리즘은 시스템을 선형으로 스케일하고, 메모리 공간도 매우 작다(최대 값을 나타내는 하나의 정수)</p><p>유감스럽게도, 알고리즘이 최대값을 가져오는 것만큼 간단하지가 않다.
더 복잡한 연산은 성능과 메모리 활용의 균형을 판단하는 알고리즘이 필요하다.
BigData, 정확성, 실시간 지연 속도의 세 가지 요소가 있다.</p><p>이 세가지 요소 중 2가지를 선택 해야 한다.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
Exact + real time
</span></dt><dd>
단일 시스템의 RAM에 적합하다. 무엇이든 가능하다. 어떤 알고리즘을 사용해도 된다. 결과는 100% 정확하고, 비교적 빠르다.
</dd><dt><span class="term">
Big data + exact
</span></dt><dd>
고전적인 Hadoop의 설치. PB(petabytes)의 데이터를 다룰 수 있고, 정확한 답을 제공할 것이다. 그러나, 그 대답에 일주일 정도 걸릴 것이다.
</dd><dt><span class="term">
Big data + real time
</span></dt><dd>
정확한 결과를 제공할 수 있는 근사 알고리즘, 그러나 100% 정확하지는 않다.
</dd></dl></div><p>현재, Elasticsearch는 2개의 근사 알고리즘(<code class="literal">cardinality</code> 와 <code class="literal">percentiles</code> )을 제공한다.<a id="id-1.7.10.9.3" class="indexterm"></a><a id="id-1.7.10.9.4" class="indexterm"></a><a id="id-1.7.10.9.5" class="indexterm"></a> 이들은 정확한 결과를 제공하지만, 100% 정확하지는 않다.
약간의 추정 오차의 대가로, 이들 알고리즘은 빠른 실행과 작은 메모리 공간을 제공한다.</p><p><span class="emphasis"><em>대부분</em></span> 의 영역에서, <span class="emphasis"><em>모든 데이터</em></span> 에 대해, <span class="emphasis"><em>실시간</em></span> 으로 반환하는 매우 정확한 결과는 100%의 정확함보다 더 중요하다. 언뜻 보기에, 이상할 수도 있다. <span class="emphasis"><em>"정확한 답변이 필요해요!"</em></span> 라고 말할 수 있다.
그러나, 0.5%의 오차에 대한 영향을 고려해 보자.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
웹사이트 지연시간의 99퍼센트는 132ms 이다.
</li><li class="listitem">
0.5% 오차를 가진 근사 값은 132ms의 +/- 0.6ms 이내이다.
</li><li class="listitem">
근사 값은 수 밀리세컨드 안에 반환될 것이다. <code class="literal">진짜</code> 답은 수초가 걸리거나 불가능할 것이다.
</li></ul></div><p>website 지연시간을 간단히 확인하는 경우, 대략적인 답이 132ms 대신 132.66ms인 것이 무슨 상관이 있겠는가?
물론, 모든 영역에서 대략적인 값을 허용할 수는 없겠지만, 대부분은 아무 문제가 되지 않는다.
하지만, 대략적인 답을 받아들이면, 비즈니스나 기술 장애보다는 <span class="emphasis"><em>문화적</em></span> 장애물을 피할 수 없게 된다.</p><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="cardinality"></a>유일한 값의 갯수 찾기</h2></div></div></div><p>Elasticsearch에서 제공되는, 첫 번째 대략적인 집계는 <code class="literal">cardinality</code> metric이다.<a id="id-1.7.10.13.2.2" class="indexterm"></a>
<a id="id-1.7.10.13.2.3" class="indexterm"></a><a id="id-1.7.10.13.2.4" class="indexterm"></a>
<a id="id-1.7.10.13.2.5" class="indexterm"></a>
<a id="id-1.7.10.13.2.6" class="indexterm"></a><a id="id-1.7.10.13.2.7" class="indexterm"></a>
<a id="id-1.7.10.13.2.8" class="indexterm"></a><a id="id-1.7.10.13.2.9" class="indexterm"></a> 이것은 <span class="emphasis"><em>고유한</em></span> 또는 <span class="emphasis"><em>유일한</em></span> 값의 수 라고 불리기도 하는,
filed의 cardinality(기수)를 제공한다. 아래 SQL 버전에 익숙할 것이다:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sql">SELECT DISTINCT(color)
FROM cars</pre></div><p>고유한 수는 일반적인 연산이고, 많은 기본적인 비즈니스 질문에 대한 답변이다:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
웹사이트에 방문한 유일한 방문자는 몇 명인가?
</li><li class="listitem">
판매한 유일한 자동차의 수는?
</li><li class="listitem">
각 달에 제품을 구매한 유일한 사용자의 수는?
</li></ul></div><p>대리점에서 판매할 자동차 색깔의 수를 결정하기 위해, <code class="literal">cardinality</code> metric을 사용할 수 있다:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /cars/transactions/_search?search_type=count
{
    "aggs" : {
        "distinct_colors" : {
            "cardinality" : {
              "field" : "color"
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/60_cardinality.json"></div><p>이 query는 3가지 다른 색상의 자동차를 판매했다는 것을 보여주는 응답을 반환한다:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">...
"aggregations": {
  "distinct_colors": {
     "value": 3
  }
}
...</pre></div><p>좀 더 유용한 예제를 만들어 보자. 각 달에 팔린 색상의 수는? 해당 통계를 위하여, <a id="id-1.7.10.13.11.1" class="indexterm"></a><code class="literal">date_histogram</code> 아래에 <code class="literal">cardinality metric</code> 을 중첩하면 된다.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /cars/transactions/_search?search_type=count
{
  "aggs" : {
      "months" : {
        "date_histogram": {
          "field": "sold",
          "interval": "month"
        },
        "aggs": {
          "distinct_colors" : {
              "cardinality" : {
                "field" : "color"
              }
          }
        }
      }
  }
}</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/60_cardinality.json"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_균형을_이해하자"></a>균형을 이해하자</h3></div></div></div><p>이 장의 초반에 언급했듯이, <code class="literal">cardinality</code> metric은 대략적인 알고리즘이다. <a id="id-1.7.10.13.14.2.2" class="indexterm"></a>
<a id="id-1.7.10.13.14.2.3" class="indexterm"></a> <a class="ulink" href="http://static.googleusercontent.com/media/research.google.com/en//pubs/archive/40671.pdf" target="_top">HyperLogLog++</a> (HLL) 알고리즘을 기반으로 한다.<a id="id-1.7.10.13.14.2.5" class="indexterm"></a><a id="id-1.7.10.13.14.2.6" class="indexterm"></a> HLL은
입력을 hashing하고, cardinality에 대한 확률론적 추정을 위해, hash에서 bit를 사용함으로써 동작한다.</p><p>기술적인 세부사항(관심이 있다면, 이 논문은 읽을만한 아주 좋은 논문이다)을 이해할 필요는 없다. 하지만 <a id="id-1.7.10.13.14.3.1" class="indexterm"></a>
<a id="id-1.7.10.13.14.3.2" class="indexterm"></a>알고리즘의 <span class="emphasis"><em>특성</em></span> 을 알고 있어야 한다:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
메모리 사용량을 제어하는, 정밀도의 설정.(더 정확 == 더 많은 메모리)
</li><li class="listitem">
낮은 cardinality 집합에 대한 우수한 정확도
</li><li class="listitem">
고정 메모리 사용량. 수천 또는 수십억의 고유한 값이 있어도 관계없다. 메모리 사용량은 설정된 정밀도에 따라 달라진다.
</li></ul></div><p>정밀도를 설정하기 위해, <code class="literal">precision_threshold</code> 매개변수를 지정해야 한다.<a id="id-1.7.10.13.14.5.2" class="indexterm"></a>
이 임계 값은 정확함에 매우 근접할 것으로 기대되는 cardinality, 아래 지점을 정의한다. 아래 예제를 살펴보자:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /cars/transactions/_search?search_type=count
{
    "aggs" : {
        "distinct_colors" : {
            "cardinality" : {
              "field" : "color",
              "precision_threshold" : 100 <a id="CO205-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/60_cardinality.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO205-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">precision_threshold</code> 는 0–40,000 사이의 숫자를 입력할 수 있다. 더 큰 값은 40,000과 동일하게 처리한다.
</p></td></tr></table></div><p>100개 이하의 고유한 값이 있는 field는 매우 정확할 거라고 보장한다.
비록 알고리즘이 보장하지는 않지만, cardinality가 임계 값 아래일 경우, 거의 항상 100% 정확하다.
이 이상의 cardinality는 메모리 절약과 약간의 오차를 거래하기 시작하고, 약간의 오차가 metric에 나타날 것이다.</p><p>주어진 임계 값에 대해, HLL 데이터 구조는 <code class="literal">precision_threshold * 8</code> bytes의 메모리를 사용할 것이다. 따라서, 추가적인 정확성과 필요한 메모리의 양의 균형을 맞추어야 한다.</p><p>실질적으로 말하자면, 임계 값 `100`은, 수백만 개의 고유한 값을 계산하는 경우에도, 5% 미만의 오차를 유지한다.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_속도의_최적화"></a>속도의 최적화</h3></div></div></div><p>유일한 값의 수를 얻으려면, 일반적으로 전체 데이터 집합(또는 거의 모든 데이터)를 검색할 것이다.<a id="id-1.7.10.13.15.2.1" class="indexterm"></a>
<a id="id-1.7.10.13.15.2.2" class="indexterm"></a><a id="id-1.7.10.13.15.2.3" class="indexterm"></a>
<a id="id-1.7.10.13.15.2.4" class="indexterm"></a>  모든 데이터에 대한 어떤 연산은 분명한 이유를 가지고,
신속하게 실행되어야 한다. HyperLolLog는 이미 매우 빠르다. 단순히 데이터를 hash하고, 약간의 bit 변형을 수행한다.<a id="id-1.7.10.13.15.2.5" class="indexterm"></a><a id="id-1.7.10.13.15.2.6" class="indexterm"></a></p><p>그러나, 속도가 매우 중요하다면, 데이터를 조금 더 최적화할 수 있다. HLL은 단순히 field의 hash가 필요하기 때문에, 색인 시에 hash를
미리 계산할 수 있다.<a id="id-1.7.10.13.15.3.1" class="indexterm"></a> query를 실행할 때, hash 계산을 생략하고,
fielddata에서 값을 바로 읽을 수 있다.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>hash를 미리 계산하는 것은 매우 큰 field 그리고/또는 높은 cardinality field일 경우에만 유용하다.
이런 field에서 hash를 계산하는 것은, query시에 무시할 수 없다.</p><p>그러나, 숫자 field의 hash는 매우 빠르다. 그리고, 원래의 숫자를 저장하는 것은, 같거나 적은 메모리를 필요로 한다.
이것은 낮은 cardinality를 가지는 문자열 field에서도 마찬가지이다. hash는 고유한 값 별로 한번만 계산된다고 보장하는 내부 최적화가 있다.</p><p>기본적으로, hash를 미리 계산하는 것은 모든 field를 더 빠르게 한다고 보장할 수는 없다. 높은 cardinality 그리고/또는 매우 큰 문자열을 가진 field에서만 더 빠르다.
그리고, 미리 계산하는 것은, 단순히 비용을 색인 시로 옮긴 것뿐이라는 것을 기억하자. 여전히 비용을 지불해야 한다. 단지 <span class="emphasis"><em>언제</em></span> 지불할지를 선택할 뿐이다.</p></div></div><p>이를 위해, 데이터에 새로운 다중 field를 추가해야 한다. index를 지우고,
hashed field를 포함하는 새로운 mapping을 추가하자. 그리고, 다시 색인하자:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">DELETE /cars/

PUT /cars/
{
  "mappings": {
    "transactions": {
      "properties": {
        "color": {
          "type": "string",
          "fields": {
            "hash": {
              "type": "murmur3" <a id="CO206-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            }
          }
        }
      }
    }
  }
}

POST /cars/transactions/_bulk
{ "index": {}}
{ "price" : 10000, "color" : "red", "make" : "honda", "sold" : "2014-10-28" }
{ "index": {}}
{ "price" : 20000, "color" : "red", "make" : "honda", "sold" : "2014-11-05" }
{ "index": {}}
{ "price" : 30000, "color" : "green", "make" : "ford", "sold" : "2014-05-18" }
{ "index": {}}
{ "price" : 15000, "color" : "blue", "make" : "toyota", "sold" : "2014-07-02" }
{ "index": {}}
{ "price" : 12000, "color" : "green", "make" : "toyota", "sold" : "2014-08-19" }
{ "index": {}}
{ "price" : 20000, "color" : "red", "make" : "honda", "sold" : "2014-11-05" }
{ "index": {}}
{ "price" : 80000, "color" : "red", "make" : "bmw", "sold" : "2014-01-01" }
{ "index": {}}
{ "price" : 25000, "color" : "blue", "make" : "ford", "sold" : "2014-02-12" }</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/60_cardinality.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO206-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
이 다중 field는 hashing function인 <code class="literal">murmur3</code> type이다.
</p></td></tr></table></div><p>이제, 집계를 실행할 때, <code class="literal">color</code> field 대신에, <code class="literal">color.hash</code> field를 사용한다.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /cars/transactions/_search?search_type=count
{
    "aggs" : {
        "distinct_colors" : {
            "cardinality" : {
              "field" : "color.hash" <a id="CO207-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/60_cardinality.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO207-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
원래 field가 아닌 hashed multi-field를 지정했다는 것에 주목하자.
</p></td></tr></table></div><p>이제, <code class="literal">cardinality</code> metric은 <code class="literal">"color.hash"</code> 에서 값(예: 미리 계산된 hash)을 가져온다.
그리고, 원래의 값을 동적으로 hashing하는 대신, 그 값을 사용할 것이다.</p><p>document당 절약되는 시간은 작다. 그러나 각 field를 hashing하는데 10ns가 추가되고, 집계가 1억건의 document를 읽어야 한다면,
query당 1초가 추가된다. 많은 document에 대해 <code class="literal">cardinality</code> 를 사용하고 있다면, 미리 계산하는 hash가 합리적이라는 것을
알아보기 위해, 약간의 profiling을 수행해 보자.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="percentiles"></a>백분위의 계산</h2></div></div></div><p>Elasticsearch에 의해 제공되는 또 다른 대략적인 metric은, <code class="literal">percentiles</code> (백분위) metric이다.<a id="id-1.7.10.14.2.2" class="indexterm"></a><a id="id-1.7.10.14.2.3" class="indexterm"></a>
<a id="id-1.7.10.14.2.4" class="indexterm"></a>
<a id="id-1.7.10.14.2.5" class="indexterm"></a><a id="id-1.7.10.14.2.6" class="indexterm"></a>
<a id="id-1.7.10.14.2.7" class="indexterm"></a>
percentiles는 관찰된 값들 중에서 특정 비율이 나타나는 지점을 나타낸다. 예를 들어, 95번째 percentile는 데이터의 95%보다 더 큰 값이다.</p><p>percentiles는 흔히 특이점을 발견하는데 사용한다. (통계적으로) 정규 분포에서, 0.13th과 99.87th의 percentiles는 평균의 세 가지 표준 편차를 나타낸다.
세 가지 표준 편차에 해당하는 데이터는, 평균 값과 너무 다르기 때문에, 흔히 특이한 것으로 간주된다.</p><p>좀 더 구체적으로, 아주 큰 웹사이트가 운영 중이고, 방문자에게 빠른 응답 시간을 보정해 주는 것이 여러분의 업무라고 가정해 보자.
따라서, 목표의 충족 여부를 확인하기 위해, 웹사이트의 응답 시간을 모니터링 해야 한다.</p><p>이 시나리오에 사용하는 공통 metric은 평균 응답 시간이다.<a id="id-1.7.10.14.5.1" class="indexterm"></a>
<a id="id-1.7.10.14.5.2" class="indexterm"></a><a id="id-1.7.10.14.5.3" class="indexterm"></a> 그러나, 평균(mean)은 특이 사항이 잘 나타나지 않기 때문에,
실제로는 좋지 않은 선택(일반적인데도 불구하고)이다. 중간 값(median) metric 또한 동일한 문제를 겪는다.<a id="id-1.7.10.14.5.4" class="indexterm"></a>
최대값(maximum)을 시도하겠지만, 이 metric은 하나의 특이 사항으로 쉽게 왜곡된다.</p><p><a class="xref" href="_대략적인_집계.html#percentile-mean-median" title="Figure 40. 평균 요청 지연 시간">Figure 40, “평균 요청 지연 시간”</a>에 있는 그래프는 그 문제를 보여준다. 평균(mean)이나 중간 값(median) 같은 단순한 metric을 사용한다면, <a class="xref" href="_대략적인_집계.html#percentile-mean-median" title="Figure 40. 평균 요청 지연 시간">Figure 40, “평균 요청 지연 시간”</a>과 같은 그래프를 볼 수 있을 것이다.</p><div class="figure"><a id="percentile-mean-median"></a><p class="title"><strong>Figure 40. 평균 요청 지연 시간</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_33in01.png" alt="평균/중간 값을 이용한 웹사이트 지연시간 평가" /></div></div></div><br class="figure-break" /><p>모든 것이 정상이다. <a id="id-1.7.10.14.8.1" class="indexterm"></a>
<a id="id-1.7.10.14.8.2" class="indexterm"></a>약간 튀는 부분도 있지만, 염려할 것은 없다.
그러나, 99th percentile(응답 시간이 가장 느린 1%를 차지하는 값)을 알아보면, <a class="xref" href="_대략적인_집계.html#percentile-mean-median-percentile" title="Figure 41. 99th percentiles metric을 사용한 평균 응답시간">Figure 41, “99th percentiles metric을 사용한 평균 응답시간”</a>에서 볼 수 있듯이, 완전히 다른 이야기를 볼 수 있다.</p><div class="figure"><a id="percentile-mean-median-percentile"></a><p class="title"><strong>Figure 41. 99th percentiles metric을 사용한 평균 응답시간</strong></p><div class="figure-contents"><div class="mediaobject"><img src="images/elas_33in02.png" alt="백분위를 이용한 웹사이트 지연시간 평가" /></div></div></div><br class="figure-break" /><p>오전 9:30에, 평균은 겨우 75ms이다. 시스템 관리자로써, 이 값을 반복해서 보지 않을 것이다. 모든 것이 정상이다.
그러나, 99th percentile은 고객 중 1%의 응답 시간이 850ms를 초과한다고 알려준다. 전혀 다른 이야기이다.
오전 4:48에도 평균/중간 값에서는 전혀 눈에 띄지도 않는 작은 문제가 있었다.</p><p>이것은 percentiles 사용 사례 중의 하나이다. 데이터를 빠르게 검토하거나, 왜곡, 이원화 등을 확인하는데 사용될 수 있다.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_percentile_metric"></a>Percentile Metric</h3></div></div></div><p>새로운 데이터 집합(자동차 데이터는 percentiles를 테스트하기에 적당하지 않다)을 만들어 보자.
website의 응답 시간을 색인하고, 거기에 percentiles를 실행한다:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST /website/logs/_bulk
{ "index": {}}
{ "latency" : 100, "zone" : "US", "timestamp" : "2014-10-28" }
{ "index": {}}
{ "latency" : 80, "zone" : "US", "timestamp" : "2014-10-29" }
{ "index": {}}
{ "latency" : 99, "zone" : "US", "timestamp" : "2014-10-29" }
{ "index": {}}
{ "latency" : 102, "zone" : "US", "timestamp" : "2014-10-28" }
{ "index": {}}
{ "latency" : 75, "zone" : "US", "timestamp" : "2014-10-28" }
{ "index": {}}
{ "latency" : 82, "zone" : "US", "timestamp" : "2014-10-29" }
{ "index": {}}
{ "latency" : 100, "zone" : "EU", "timestamp" : "2014-10-28" }
{ "index": {}}
{ "latency" : 280, "zone" : "EU", "timestamp" : "2014-10-29" }
{ "index": {}}
{ "latency" : 155, "zone" : "EU", "timestamp" : "2014-10-29" }
{ "index": {}}
{ "latency" : 623, "zone" : "EU", "timestamp" : "2014-10-28" }
{ "index": {}}
{ "latency" : 380, "zone" : "EU", "timestamp" : "2014-10-28" }
{ "index": {}}
{ "latency" : 319, "zone" : "EU", "timestamp" : "2014-10-29" }</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/65_percentiles.json"></div><p>이 데이터는 3가지 값(응답 시간-latency, 데이터 센터의 지역-zone, 타임스탬프-timestamp)을 가지고 있다.
분포의 느낌을 얻기 위해, 전체 데이터 집합에 <code class="literal">percentiles</code> 를 실행해 보자:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /website/logs/_search?search_type=count
{
    "aggs" : {
        "load_times" : {
            "percentiles" : {
                "field" : "latency" <a id="CO208-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            }
        },
        "avg_load_time" : {
            "avg" : {
                "field" : "latency" <a id="CO208-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/65_percentiles.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO208-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">percentiles</code> metric이 <code class="literal">latency</code> field에 적용되었다.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO208-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
비교하기 위해, 동일한 field에 <code class="literal">avg</code> metric을 동시에 실행하였다.
</p></td></tr></table></div><p>기본적으로, <code class="literal">percentiles metric</code> 은 미리 정의된 percentiles의 배열( <code class="literal">[1, 5, 25, 50, 75, 95, 99]</code> )을 반환한다.
이것은 사람들이 관심을 가지는, 일반적인 percentiles(스펙트럼의 끝, 중간의 몇 개중에 극단적인 percentiles)를 나타낸다.
응답에서 가장 빠른 응답 시간은 약 75ms이다. 반면에 가장 느린 응답 시간은 거의 600ms이다. 반대로, 평균은 거의 200ms이다.<a id="id-1.7.10.14.12.9.3" class="indexterm"></a>
<a id="id-1.7.10.14.12.9.4" class="indexterm"></a> 거의 도움이 되지 않는다:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">...
"aggregations": {
  "load_times": {
     "values": {
        "1.0": 75.55,
        "5.0": 77.75,
        "25.0": 94.75,
        "50.0": 101,
        "75.0": 289.75,
        "95.0": 489.34999999999985,
        "99.0": 596.2700000000002
     }
  },
  "avg_load_time": {
     "value": 199.58333333333334
  }
}</pre></div><p>따라서, 응답 시간에는 분명히 넓은 분포가 있다. 데이터센터의 지리적 위치와 상관관계가 있는지 알아보자:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /website/logs/_search?search_type=count
{
    "aggs" : {
        "zones" : {
            "terms" : {
                "field" : "zone" <a id="CO209-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            },
            "aggs" : {
                "load_times" : {
                    "percentiles" : { <a id="CO209-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
                      "field" : "latency",
                      "percents" : [50, 95.0, 99.0] <a id="CO209-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
                    }
                },
                "load_avg" : {
                    "avg" : {
                        "field" : "latency"
                    }
                }
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/65_percentiles.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO209-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
먼저, zone에 따라 응답 시간(latency)를 bucket으로 분리한다.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO209-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
그 다음에 zone별로 percentiles를 계산한다.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO209-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">percents</code> 매개변수는 반환될 percentiles의 배열을 가진다. 느린 응답시간에만 관심이 있다.
</p></td></tr></table></div><p>응답에서, EU지역이 US지역보다 훨씬 더 느린 것을 알 수 있다. US지역에서는 50th percentile이 99th percentile에 거의 근접해 있다. 그리고, 모두 평균에 가깝다.</p><p>반면에, EU지역은 50th과 99th percentile 사이에 큰 차이가 있다. EU지역이 지연 시간 metric을 끌어 내리고 있는 것은 분명하다. EU지역 50%의 지연 시간이 300ms 이상인 것을 알 수 있다.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">...
"aggregations": {
  "zones": {
     "buckets": [
        {
           "key": "eu",
           "doc_count": 6,
           "load_times": {
              "values": {
                 "50.0": 299.5,
                 "95.0": 562.25,
                 "99.0": 610.85
              }
           },
           "load_avg": {
              "value": 309.5
           }
        },
        {
           "key": "us",
           "doc_count": 6,
           "load_times": {
              "values": {
                 "50.0": 90.5,
                 "95.0": 101.5,
                 "99.0": 101.9
              }
           },
           "load_avg": {
              "value": 89.66666666666667
           }
        }
     ]
  }
}
...</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_percentile_순위"></a>percentile 순위</h3></div></div></div><p><code class="literal">percentile_rank</code> 라 불리는, 밀접하게<a id="id-1.7.10.14.13.2.2" class="indexterm"></a>
<a id="id-1.7.10.14.13.2.3" class="indexterm"></a>
<a id="id-1.7.10.14.13.2.4" class="indexterm"></a><a id="id-1.7.10.14.13.2.5" class="indexterm"></a>
<a id="id-1.7.10.14.13.2.6" class="indexterm"></a> 연관된 또 하나의 metric이 있다.
<code class="literal">percentiles</code> metric은 주어진 document의 비율 아래에 가장 작은 값을 알려준다. 예를 들어, 50th percentile이 119ms이면, document의 50%는 119ms 보다 더 큰 값을 가지지 않는다. <code class="literal">percentile_rank</code> 는 특정 값에 해당하는 percentile을 알려준다.
119ms의 <code class="literal">percentile_rank</code> 는 50th percentile이다. 기본적으로 양방향 관계이다.
예를 들면:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
50th percentile은 119ms이다.
</li><li class="listitem">
119ms의 percentile rank는 50th percentile이다.
</li></ul></div><p>website가 응답 시간 210ms이하의 SLA 를 유지해야 하고, 그리고, 재미를 위해서, 관리자가 응답 시간이 800ms 이상이면 해고한다는 협박을 하고 있다고 가정해 보자.
여러분은 당연히 SLA를 충족시키는 요청의 비율을 알고 싶을 것이다(그리고 800ms미만이길 바랄 것이다).</p><p>이를 위해, <code class="literal">percentiles</code> 대신에 <code class="literal">percentile_rank</code> metric을 적용할 수 있다.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">GET /website/logs/_search?search_type=count
{
    "aggs" : {
        "zones" : {
            "terms" : {
                "field" : "zone"
            },
            "aggs" : {
                "load_times" : {
                    "percentile_ranks" : {
                      "field" : "latency",
                      "values" : [210, 800] <a id="CO210-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
                    }
                }
            }
        }
    }
}</pre></div><div class="sense_widget" data-snippet="snippets/300_Aggregations/65_percentiles.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO210-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">percentile_rank</code> metric은 원하는 순위의 값의 배열을 가진다.
</p></td></tr></table></div><p>이 집계를 실행한 후에, 두 가지 값을 얻을 수 있다:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"aggregations": {
  "zones": {
     "buckets": [
        {
           "key": "eu",
           "doc_count": 6,
           "load_times": {
              "values": {
                 "210.0": 31.944444444444443,
                 "800.0": 100
              }
           }
        },
        {
           "key": "us",
           "doc_count": 6,
           "load_times": {
              "values": {
                 "210.0": 100,
                 "800.0": 100
              }
           }
        }
     ]
  }
}</pre></div><p>여기에서 3가지 중요한 점을 알 수 있다.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
EU지역에서, 210ms에 대한 percentile rank는 31.94%이다.
</li><li class="listitem">
US지역에서, 210ms에 대한 percentile rank는 100%이다.
</li><li class="listitem">
EU, US 양쪽 지역에서, 800ms에 대한 percentile rank는 100%이다.
</li></ul></div><p>쉽게 말하면, EU지역은 SLA의 32%만을 만족시키는데, US지역은 항상 SLA를 만족시킨다.
그러나, 다행스럽게도, 양쪽 지역 모두 800ms 아래이다. 그래서 해고되지 않을 것이다.(아직은!)</p><p><code class="literal">percentile_rank</code> metric은 <code class="literal">percentiles</code> 와 동일한 정보를 제공한다.
그러나 특정 값에 관심이 있다면, 더 편리한 방법이다.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_상충관계의_이해"></a>상충관계의 이해</h3></div></div></div><p>cardinality와 마찬가지로, percentiles를 계산하는 것은 근사 알고리즘을 필요로 한다.<a id="id-1.7.10.14.14.2.1" class="indexterm"></a>
<a id="id-1.7.10.14.14.2.2" class="indexterm"></a><a id="id-1.7.10.14.14.2.3" class="indexterm"></a>
<a id="id-1.7.10.14.14.2.4" class="indexterm"></a>
<a id="id-1.7.10.14.14.2.5" class="indexterm"></a> 단순하게 구현하면, 모든 값의 정렬된 목록을 유지하는 것이다.
하지만, 수십 개의 node에 분산된 수십억 개의 값을 가지고 있을 경우, 이것은 불가능하다.</p><p>대신, <code class="literal">percentiles</code> 는 <a id="id-1.7.10.14.14.3.2" class="indexterm"></a>TDigest(<a class="ulink" href="http://bit.ly/1DIpOWK" target="_top">Computing Extremely Accurate Quantiles Using T-Digests</a> 에서 Ted Dunning에 의해 소개된)라 불리는 알고리즘을 사용한다.
HyperLogLog와 마찬가지로, 기술적인 세부사항 전체를 이해할 필요는 없다.
그러나, 알고리즘의 특성을 알고 있는 것이 좋다:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
percentile의 정밀도는 percentile가 얼마나 <span class="emphasis"><em>극단적(extreme)</em></span> 인가에 비례한다.
즉, 1st이나 99th같은 percentiles는 50th보다 더 정확하다. 이것은 단지 데이터의 구조가 동작하는 방법의 특성이지만,
대부분의 사람들은 극단적인 percentiles에 대해 주의하기 때문에, 좋은 특성이 된다.
</li><li class="listitem">
값이 작은 집합일 경우, percentiles는 매우 정확하다. 데이터 집합이 충분히 작으면,
percentiles는 100% 정확할 것이다.
</li><li class="listitem">
bucket에 있는 값의 양이 증가함에 따라, 알고리즘은 percentiles에 근접하기 시작한다.
효과적으로 정확성을 메모리 절약과 교환한다. 부정확성의 정확한 수준은, <a id="id-1.7.10.14.14.4.3.1.1" class="indexterm"></a>
데이터의 분포나 집계되는 데이터의 양에 따라 달라지기 때문에, 일반화하기 어렵다.<a id="id-1.7.10.14.14.4.3.1.2" class="indexterm"></a>
<a id="id-1.7.10.14.14.4.3.1.3" class="indexterm"></a>
</li></ul></div><p><code class="literal">cardinality`와 마찬가지로, `compression</code> 매개변수를 변경하여, 메모리와 정확성의 비율을 제어할 수 있다.</p><p>TDigest 알고리즘은 대략적인 percentiles에, node의 수를 사용한다. 이용할 수 있는 node가 많을수록, 데이터의 양에 비례하여, 정확성(과 큰 메모리 공간)이 더 높다.
compression 매개변수는, <code class="literal">20 * compression</code> 로, 최대 node 수를 제한한다.</p><p>따라서, compression 값을 증가시킴으로써, 더 많은 메모리 비용으로, percentiles의 정확성을 증가시킬 수 있다.
더 큰 compression 값은 기본 tree 데이터 구조의 크기를 증가시켜, 더 비싼 연산으로 나타나기 때문에, 알고리즘을 느리게 만든다. compression의 기본 값은 <code class="literal">100</code> 이다.</p><p>어떤 node가 대략 32byte의 메모리를 사용한다면, 최악의 시나리오(정리정돈 되어 도착한 많은 양의 데이터)에서,
기본 설정은 64KB 정도로 TDigest를 생성한다. 실제에서 데이터는 더 무작위이고, TDigest는 더 적은 메모리를 사용할 것이다.</p></div></div></div><div class="navfooter"><span class="prev"><a href="_다중_값_bucket의_정렬.html">
              « 
              다중 값 bucket의 정렬</a>
           
        </span><span class="next">
           
          <a href="significant-terms.html">의미 있는 단어
               »
            </a></span></div>
<!-- end body -->

            </section>

            <div id="rtpcontainer"
        >
	<h3>Top Videos</h3>
	<ul class="lists">
		<li><a href="https://www.elastic.co/webinars/get-started-with-elasticsearch/?baymax=default&elektra=docs&storm=top-video">Getting Started</a></li>
		<li><a href="http://www.elastic.co/webinars/elasticsearch-performance-optimization-tale-two-tickets/?elektra=docs">Scaling</a></li>
		<li><a href="http://www.elastic.co/webinars/shield-securing-your-data-in-elasticsearch/?elektra=docs">Security</a></li>
	</ul>
</div>


	  	




<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
	<!-- subscribe-newsletter -->
	<div id="subscribe-newsletter">
		<div class="container">
			<div class="row">
				<div class="12u">
					<div class="subscribe-wrapper" id="rtp-newsletter">
						<header>
							<h3>Subscribe to our newsletter</h3>
						</header>
						<div class="subscribe-form">
							<form id="mktoForm_1398" class="container"></form>
							<div class="form_thanks hide">
								
									<p>Thanks for subscribing! We'll keep you updated with new releases.</p>
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

  	<!-- Footer -->
	<div id="footer-wrapper">
		<section id="footer" class="container">
			<div class="row">
				<div class="12u">
					<!-- Copyright -->
					<div id="copyright">
	<p>
		© 2016. All Rights Reserved - Elasticsearch
	</p>
	<ul class="links">
		<li>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries</li>
		<li><a href="/legal/trademarks" id="footer_trademarks">Trademarks</a></li>
		<li><a href="/legal/terms-of-use" id="footer_terms">Terms</a></li>
		<li><a href="/legal/privacy-policy" id="footer_privacy">Privacy</a></li>
	</ul>
	<p>
		Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/" target="_blank">Apache Software Foundation</a> in the United States and/or other&nbsp;countries.
	</p>
</div><!--<div class="row">
{replace4}
</div>-->
				</div>
			</div>					
		</section>
	</div>
			
	<!-- Social Media -->
	<div id="socialmedia-wrapper">
		<section id="socialmedia" class="container">
			<!-- social icons -->
			<div id="social">
				<ul class="links">
					
						<li class="facebook grayscale"><a href="http://www.facebook.com/elastic.co" target="_blank" id="footer_facebook"></a></li>
					
						<li class="twitter grayscale"><a href="https://www.twitter.com/elastic" target="_blank" id="footer_twitter"></a></li>
					
						<li class="linkedin grayscale"><a href="https://www.linkedin.com/company/elastic-co" target="_blank" id="footer_linkedin"></a></li>
					
						<li class="xing grayscale"><a href="https://www.xing.com/companies/elastic.co" target="_blank" id="footer_xing"></a></li>
					
						<li class="youtube grayscale"><a href="https://www.youtube.com/user/elasticsearch" target="_blank" id="footer_youtube"></a></li>
					
				</ul>
			</div>
		</section>
	</div>


<style type="text/css">
	
		.facebook{background:url("https://static-www.elastic.co/assets/bltda40eebd7c7cae9a/facebook.svg?q=100") no-repeat;}		
	
		.twitter{background:url("https://static-www.elastic.co/assets/bltfd3b1511512f4632/twitter.svg?q=100") no-repeat;}		
	
		.linkedin{background:url("https://static-www.elastic.co/assets/blt6b4f6f8d6b96f814/linkedin.svg?q=100") no-repeat;}		
	
		.xing{background:url("https://static-www.elastic.co/assets/blta76b2ae2b2f10a98/xing.svg?q=100") no-repeat;}		
	
		.youtube{background:url("https://static-www.elastic.co/assets/blt5761648c9581fb53/youtube.svg?q=100") no-repeat;}		
	
</style>

<script>
MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
	form.onSuccess(function(form){
		$('#mktoForm_1398').css('display','none');
		$('#subscribe-newsletter header').hide();
		$('#mktoForm_1398').siblings('.form_thanks').removeClass('hide')
		dataLayer.push({'event': 'mktoFormSubmit'});
	    return false;
  	});
});
</script>	

  	</div>
  	<!-- <div class="preloader">
    	<div class="status"></div>
	</div> -->
  	<style></style>
   	<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
</script>
<script src="https://static-www.elastic.co/static/js/jquery.autocomplete.js?q=100"></script>
<script src="https://static-www.elastic.co/static/js/script.js?q=100"></script>


   	
   	
   	
   	<script type="application/ld+json">
	
		
	
	{
	  	"@context": "http://schema.org",
	  	"@type": "Organization",
	  	"name" : "Elastic",
	  	"url": "https://www.elastic.co/",
	  	"logo": "https://www.elastic.co/static/img/elastic-logo-200.png",
		"sameAs" : [ "https://www.facebook.com/elastic.co",
			"https://twitter.com/elastic",
			"https://plus.google.com/105178019064686397293",
			"https://www.youtube.com/user/elasticsearch",
			"https://www.linkedin.com/company/elasticsearch"
		],
	  	"potentialAction": {
	    	"@type": "SearchAction",
	    	"target": "https://www.elastic.co/search?q={query_string}",
	    	"query-input": "required name=query_string"
	  	}
	}
</script>	

            <script type="text/javascript" src="docs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type='text/javascript' src='https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js'></script>

            </body>
        

